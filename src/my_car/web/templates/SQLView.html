{% extends "layout.html" %}
{% block content %}
 <script src="https://cdn.datatables.net/1.10.16/js/jquery.dataTables.min.js"></script>
 <script src="https://cdn.datatables.net/1.10.16/js/dataTables.bootstrap4.min.js"></script>
 <script type="text/javascript" src="{{ url_for('static', filename='js/index.js')}}"></script>

<div style="margin:50px 0 0 0; ">
      <table id="example" class="table table-striped table-bordered" style="width:100%;">
        <thead>
          <tr>
            <td width="8%" align="center">No</td>
            <td width="12%" align="center">Area</td>
            <td width="15%" align="center">Temperture (&#176;C)</td>
            <td width="15%" align="center">Humidity (%)</td>
            <td width="15%" align="center">CO2 (ppm)</td>
            <td width="20%" align="center">Time</td>
            <td width="15%" align="center">Action</td>
          </tr>
        </thead>
        <tbody>
          {% for row in list_users %}
          <tr>
            <td align="center">{{row[0]}}</td> <!-- record_no -->
            <td align="center">{{row[1]}}</td> <!-- Position -->
            <td align="center">{{row[2]}}</td> <!-- Temperture -->
            <td align="center">{{row[3]}}</td> <!-- Humidity -->
            <td align="center">{{row[4]}}</td> <!-- CO2 -->
            <td align="center">{{row[5]}}</td> <!-- Time -->
            <td align="center">
              <a href="/edit/{{row[0]}}" class="btn btn-secondary btn-sm">edit</a>
              <a href="/delete/{{row[0]}}" class="btn btn-danger btn-delete btn-sm">delete</a>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
</div> 
<div>
  <canvas id="myChart"></canvas>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
  const ctx = document.getElementById('myChart');
  
  var IoTdata = {{list_users | tojson}};
  var A0val = [];
  var A0time = [];
  for (var i=0; i<IoTdata.length; i++){
    if (IoTdata[i][1] == 'A0'){
      A0val.push(IoTdata[i][2]);
      A0time.push(IoTdata[i][5]);
    }
  }
  const labels = A0time;
  const data = {
    labels: labels,
    datasets: [{
      label: 'My First Dataset',
      data: A0val,
      fill: false,
      borderColor: 'rgb(75, 192, 192)',
      tension: 0.1
    }]
  };
  new Chart(ctx, {
    type: 'line',
    data: data,
    options: {
      scales: {
        y: {
          min: 23,
          max: 27
        }
      }
    }
  });

$(document).ready(function() {
    $('#example').DataTable({     
      "aLengthMenu": [[3, 5, 10, 25, -1], [3, 5, 10, 25, "All"]],
        "iDisplayLength": 3
       } 
    );
} );
</script>
<!--<script type="text/javascript" src="{{ url_for('static', filename='assets/js/jquery.min.js')}}"></script>-->
<script type="text/javascript" src="{{ url_for('static', filename='assets/js/browser.min.js')}}"></script>
<script type="text/javascript" src="{{ url_for('static', filename='assets/js/breakpoints.min.js')}}"></script>
<script type="text/javascript" src="{{ url_for('static', filename='assets/js/util.js')}}"></script>
<script type="text/javascript" src="{{ url_for('static', filename='assets/js/main.js')}}"></script>
{% endblock %}
